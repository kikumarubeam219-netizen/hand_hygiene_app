# Hand Hygiene 5 Moments Tracker - TODO

## フェーズ1: 基本セットアップ
- [x] アプリロゴの生成と設定
- [x] テーマカラーの定義（5つのタイミング別色分け）
- [x] ホーム画面の基本レイアウト実装

## フェーズ2: メイン記録機能
- [x] 5つのタイミングのイラスト/アイコン表示
- [x] 記録画面（モーダル）の実装
- [x] 実施内容の選択機能（手指消毒/手洗い/実施なし）
- [x] ローカルストレージへのデータ保存
- [x] ホーム画面のカウンター表示

## フェーズ3: 統計機能
- [x] 統計画面の基本レイアウト
- [x] 日別統計の計算と表示
- [x] 週別統計の計算と表示
- [x] 月別統計の計算と表示
- [x] グラフ/チャート表示（5つのタイミング別）
- [x] 実施率の計算と表示

## フェーズ4: チェックシート機能
- [x] チェックシート画面の基本レイアウト
- [x] 記録データのテーブル表示
- [x] チェックシートのスクロール機能
- [x] 記録の削除機能
- [ ] PDF出力機能（オプション）

## フェーズ5: ナビゲーション
- [x] タブバーの実装（ホーム/統計/チェックシート/設定）
- [x] 各タブ間の遷移
- [ ] 画面遷移のアニメーション

## フェーズ6: 設定画面
- [x] ユーザー名/施設名入力フォーム
- [x] 設定の保存
- [x] データリセット機能
- [x] 情報表示

## フェーズ7: テストと最適化
- [ ] ユーザーフロー全体のテスト
- [ ] パフォーマンス最適化
- [ ] ダークモード対応確認
- [ ] 複数デバイスでの表示確認

## フェーズ8: デプロイ準備
- [ ] 最終チェックポイント作成
- [ ] ユーザーへの提供

## フェーズ8: 機能追加（ユーザーリクエスト）
- [x] ホーム画面での記録削除・取り消し機能
- [x] 統計画面でのカスタム期間選択（日付範囲指定）
- [x] CSV出力機能の実装
- [x] 削除確認ダイアログの追加
- [x] 期間選択UIの改善

## フェーズ9: グラフ表示機能
- [x] 円グラフコンポーネントの実装
- [x] 統計画面に実施率の円グラフを追加
- [x] タイミング別実施数の円グラフ表示
- [x] グラフのカラーカスタマイズ

## フェーズ10: PDF出力機能（観察フォーム形式）
- [x] 観察フォーム形式のPDFテンプレート作成
- [x] 記録データをPDFに変換する機能実装
- [x] 施設情報・観察者情報の入力機能
- [x] 設定画面にPDF出力ボタン追加
- [x] PDF表示機能の実装

## フェーズ11: 修正・改善
- [x] PDF出力機能の修正（ブラウザ環境での対応）
- [x] タイミング別実施率の計算機能
- [x] タイミング別実施率の円グラフ表示
- [x] 統計画面のUI改善（タイミング別グラフの追加）

## フェーズ12: PDF出力機能の修正
- [x] React Native環境でのPDF出力対応
- [x] Share APIを使用したPDF共有機能
- [x] HTMLファイルの生成と保存
- [x] エラーハンドリングの改善

## フェーズ13: スマートフォン環境でのPDF出力修正
- [x] React Native環境の判定ロジックの修正
- [x] expo-file-systemとexpo-sharingの正確な使用
- [x] エラーハンドリングの改善
- [x] スマートフォン環境でのテスト

### フェーズ14: PDF形式の修正（況州感染防止ネットワーク公式フォーム対応）
- [x] 公式フォーム形式の分析
- [x] PDFテンプレートの作成（pdf-lib使用）
- [x] 記録データをPDFテンプレートに埋め込む機能
- [x] バックエンドAPIエンドポイントの実装
- [x] 複数セッション対応（8セッション分）

## フェーズ15: PDF生成機能の修正・デバッグ
- [x] バックエンドのPDF生成APIが応答しない問題の調査
- [x] HTMLベースのPDF生成に変更
- [x] フロントエンドのエラーハンドリング改善
- [x] 観察フォーム形式HTMLを生成してダウンロード
- [x] Web・スマートフォン両環境で動作確認

## フェーズ16: PDFレポート形式の変更
- [x] タイミングごとに実施内容を個別項目として表示
- [x] 1つのタイミングに対して３つの行（手指消毒・手洗い・実施なし）を作成
- [x] 番号付けの実装（1.患者接触前 手指消毒、２.患者接触前 手洗い、など）
- [x] テーブルレイアウトの改善

## フェーズ17: PDFレポート「チェック」欄削除
- [x] テーブルの「チェック」列を削除
- [x] テーブルヘッダーの調整
- [x] 列幅の再計算

## フェーズ18: PDFレポート色分け削除
- [x] テーブル行の背景色を削除
- [x] 記録状态に関わらず統一された背景色に変更
- [x] CSSスタイルの更新

## フェーズ19: PDFレポート実施順序表示
- [x] 記録データを時系列でソート
- [x] 実際の記録順に表示
- [x] 連番を記録順に付け直す
- [x] PDFレポート生成ロジックの変更

## フェーズ20: スマートフォン環境でのキャッシュディレクトリ問題修正
- [x] ドキュメントディレクトリの使用
- [x] 複数のディレクトリ取得方法の試行
- [x] エラーハンドリングの改善
- [x] スマートフォン環境での動作確認

## フェーズ21: スマートフォン環境でのファイルディレクトリ取得問題修正
- [x] Blob + Share APIの直接使用
- [x] Base64エンコードされたHTMLの共有
- [x] ファイルシステムに依存しない実装
- [x] スマートフォン環境でのテスト

## フェーズ22: ブラウザアクティビティ問題修正
- [x] Share APIを使用した直接共有
- [x] メール共有機能の実装
- [x] HTMLファイルの生成と保存
- [x] ユーザーフレンドリーなエラーメッセージ
